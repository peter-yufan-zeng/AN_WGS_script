Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 4
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	all
	1	catAlleleCountFiles
	4	combineTitanAndIchorCNA
	1	copyOptSolution
	23	getAlleleCountsByChr
	1	ichorCNA
	4	runTitanCNA
	1	selectSolution
	36

[Wed Feb 10 13:43:18 2021]
rule getAlleleCountsByChr:
    input: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr1.vcf, /scratch/n/nicholsa/zyfniu/singularity_images/TitanCNA/scripts/snakemake/results/tumor_sample_1.filtered.bam
    output: results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr1.txt
    log: logs/titan/tumCounts/tumor_sample_1/tumor_sample_1.chrchr1.log
    jobid: 13
    wildcards: tumor=tumor_sample_1, chr=chr1
    threads: 2


[Wed Feb 10 13:43:18 2021]
rule getAlleleCountsByChr:
    input: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr2.vcf, /scratch/n/nicholsa/zyfniu/singularity_images/TitanCNA/scripts/snakemake/results/tumor_sample_1.filtered.bam
    output: results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr2.txt
    log: logs/titan/tumCounts/tumor_sample_1/tumor_sample_1.chrchr2.log
    jobid: 14
    wildcards: tumor=tumor_sample_1, chr=chr2
    threads: 2

[Wed Feb 10 14:12:10 2021]
Finished job 13.
1 of 36 steps (3%) done

[Wed Feb 10 14:12:10 2021]
rule getAlleleCountsByChr:
    input: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr3.vcf, /scratch/n/nicholsa/zyfniu/singularity_images/TitanCNA/scripts/snakemake/results/tumor_sample_1.filtered.bam
    output: results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr3.txt
    log: logs/titan/tumCounts/tumor_sample_1/tumor_sample_1.chrchr3.log
    jobid: 15
    wildcards: tumor=tumor_sample_1, chr=chr3
    threads: 2

[Wed Feb 10 14:16:09 2021]
Finished job 14.
2 of 36 steps (6%) done

[Wed Feb 10 14:16:09 2021]
rule getAlleleCountsByChr:
    input: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr5.vcf, /scratch/n/nicholsa/zyfniu/singularity_images/TitanCNA/scripts/snakemake/results/tumor_sample_1.filtered.bam
    output: results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr5.txt
    log: logs/titan/tumCounts/tumor_sample_1/tumor_sample_1.chrchr5.log
    jobid: 17
    wildcards: tumor=tumor_sample_1, chr=chr5
    threads: 2

[Wed Feb 10 14:39:54 2021]
Finished job 15.
3 of 36 steps (8%) done

[Wed Feb 10 14:39:54 2021]
rule getAlleleCountsByChr:
    input: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr6.vcf, /scratch/n/nicholsa/zyfniu/singularity_images/TitanCNA/scripts/snakemake/results/tumor_sample_1.filtered.bam
    output: results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr6.txt
    log: logs/titan/tumCounts/tumor_sample_1/tumor_sample_1.chrchr6.log
    jobid: 18
    wildcards: tumor=tumor_sample_1, chr=chr6
    threads: 2

[Wed Feb 10 14:41:09 2021]
Finished job 17.
4 of 36 steps (11%) done

[Wed Feb 10 14:41:09 2021]
rule getAlleleCountsByChr:
    input: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr4.vcf, /scratch/n/nicholsa/zyfniu/singularity_images/TitanCNA/scripts/snakemake/results/tumor_sample_1.filtered.bam
    output: results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr4.txt
    log: logs/titan/tumCounts/tumor_sample_1/tumor_sample_1.chrchr4.log
    jobid: 16
    wildcards: tumor=tumor_sample_1, chr=chr4
    threads: 2

[Wed Feb 10 15:04:05 2021]
Finished job 16.
5 of 36 steps (14%) done

[Wed Feb 10 15:04:05 2021]
rule getAlleleCountsByChr:
    input: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr8.vcf, /scratch/n/nicholsa/zyfniu/singularity_images/TitanCNA/scripts/snakemake/results/tumor_sample_1.filtered.bam
    output: results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr8.txt
    log: logs/titan/tumCounts/tumor_sample_1/tumor_sample_1.chrchr8.log
    jobid: 20
    wildcards: tumor=tumor_sample_1, chr=chr8
    threads: 2

[Wed Feb 10 15:04:08 2021]
Finished job 18.
6 of 36 steps (17%) done

[Wed Feb 10 15:04:08 2021]
rule getAlleleCountsByChr:
    input: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr10.vcf, /scratch/n/nicholsa/zyfniu/singularity_images/TitanCNA/scripts/snakemake/results/tumor_sample_1.filtered.bam
    output: results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr10.txt
    log: logs/titan/tumCounts/tumor_sample_1/tumor_sample_1.chrchr10.log
    jobid: 22
    wildcards: tumor=tumor_sample_1, chr=chr10
    threads: 2

[Wed Feb 10 15:22:57 2021]
Finished job 20.
7 of 36 steps (19%) done

[Wed Feb 10 15:22:57 2021]
rule getAlleleCountsByChr:
    input: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr7.vcf, /scratch/n/nicholsa/zyfniu/singularity_images/TitanCNA/scripts/snakemake/results/tumor_sample_1.filtered.bam
    output: results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr7.txt
    log: logs/titan/tumCounts/tumor_sample_1/tumor_sample_1.chrchr7.log
    jobid: 19
    wildcards: tumor=tumor_sample_1, chr=chr7
    threads: 2

[Wed Feb 10 15:23:22 2021]
Finished job 22.
8 of 36 steps (22%) done

[Wed Feb 10 15:23:22 2021]
rule getAlleleCountsByChr:
    input: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr11.vcf, /scratch/n/nicholsa/zyfniu/singularity_images/TitanCNA/scripts/snakemake/results/tumor_sample_1.filtered.bam
    output: results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr11.txt
    log: logs/titan/tumCounts/tumor_sample_1/tumor_sample_1.chrchr11.log
    jobid: 23
    wildcards: tumor=tumor_sample_1, chr=chr11
    threads: 2

[Wed Feb 10 15:41:00 2021]
Finished job 23.
9 of 36 steps (25%) done

[Wed Feb 10 15:41:00 2021]
rule getAlleleCountsByChr:
    input: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr12.vcf, /scratch/n/nicholsa/zyfniu/singularity_images/TitanCNA/scripts/snakemake/results/tumor_sample_1.filtered.bam
    output: results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr12.txt
    log: logs/titan/tumCounts/tumor_sample_1/tumor_sample_1.chrchr12.log
    jobid: 24
    wildcards: tumor=tumor_sample_1, chr=chr12
    threads: 2

[Wed Feb 10 15:43:16 2021]
Finished job 19.
10 of 36 steps (28%) done

[Wed Feb 10 15:43:16 2021]
rule getAlleleCountsByChr:
    input: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr9.vcf, /scratch/n/nicholsa/zyfniu/singularity_images/TitanCNA/scripts/snakemake/results/tumor_sample_1.filtered.bam
    output: results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr9.txt
    log: logs/titan/tumCounts/tumor_sample_1/tumor_sample_1.chrchr9.log
    jobid: 21
    wildcards: tumor=tumor_sample_1, chr=chr9
    threads: 2

[Wed Feb 10 15:59:58 2021]
Finished job 24.
11 of 36 steps (31%) done

[Wed Feb 10 15:59:58 2021]
rule getAlleleCountsByChr:
    input: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr13.vcf, /scratch/n/nicholsa/zyfniu/singularity_images/TitanCNA/scripts/snakemake/results/tumor_sample_1.filtered.bam
    output: results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr13.txt
    log: logs/titan/tumCounts/tumor_sample_1/tumor_sample_1.chrchr13.log
    jobid: 25
    wildcards: tumor=tumor_sample_1, chr=chr13
    threads: 2

[Wed Feb 10 16:00:20 2021]
Finished job 21.
12 of 36 steps (33%) done

[Wed Feb 10 16:00:20 2021]
rule getAlleleCountsByChr:
    input: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr14.vcf, /scratch/n/nicholsa/zyfniu/singularity_images/TitanCNA/scripts/snakemake/results/tumor_sample_1.filtered.bam
    output: results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr14.txt
    log: logs/titan/tumCounts/tumor_sample_1/tumor_sample_1.chrchr14.log
    jobid: 26
    wildcards: tumor=tumor_sample_1, chr=chr14
    threads: 2

[Wed Feb 10 16:12:22 2021]
Finished job 26.
13 of 36 steps (36%) done

[Wed Feb 10 16:12:22 2021]
rule getAlleleCountsByChr:
    input: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr18.vcf, /scratch/n/nicholsa/zyfniu/singularity_images/TitanCNA/scripts/snakemake/results/tumor_sample_1.filtered.bam
    output: results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr18.txt
    log: logs/titan/tumCounts/tumor_sample_1/tumor_sample_1.chrchr18.log
    jobid: 30
    wildcards: tumor=tumor_sample_1, chr=chr18
    threads: 2

[Wed Feb 10 16:13:56 2021]
Finished job 25.
14 of 36 steps (39%) done

[Wed Feb 10 16:13:56 2021]
rule getAlleleCountsByChr:
    input: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr16.vcf, /scratch/n/nicholsa/zyfniu/singularity_images/TitanCNA/scripts/snakemake/results/tumor_sample_1.filtered.bam
    output: results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr16.txt
    log: logs/titan/tumCounts/tumor_sample_1/tumor_sample_1.chrchr16.log
    jobid: 28
    wildcards: tumor=tumor_sample_1, chr=chr16
    threads: 2

[Wed Feb 10 16:23:07 2021]
Finished job 30.
15 of 36 steps (42%) done

[Wed Feb 10 16:23:07 2021]
rule getAlleleCountsByChr:
    input: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr15.vcf, /scratch/n/nicholsa/zyfniu/singularity_images/TitanCNA/scripts/snakemake/results/tumor_sample_1.filtered.bam
    output: results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr15.txt
    log: logs/titan/tumCounts/tumor_sample_1/tumor_sample_1.chrchr15.log
    jobid: 27
    wildcards: tumor=tumor_sample_1, chr=chr15
    threads: 2

[Wed Feb 10 16:23:16 2021]
Finished job 28.
16 of 36 steps (44%) done

[Wed Feb 10 16:23:16 2021]
rule getAlleleCountsByChr:
    input: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr17.vcf, /scratch/n/nicholsa/zyfniu/singularity_images/TitanCNA/scripts/snakemake/results/tumor_sample_1.filtered.bam
    output: results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr17.txt
    log: logs/titan/tumCounts/tumor_sample_1/tumor_sample_1.chrchr17.log
    jobid: 29
    wildcards: tumor=tumor_sample_1, chr=chr17
    threads: 2

[Wed Feb 10 16:32:58 2021]
Finished job 29.
17 of 36 steps (47%) done

[Wed Feb 10 16:32:58 2021]
rule getAlleleCountsByChr:
    input: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr20.vcf, /scratch/n/nicholsa/zyfniu/singularity_images/TitanCNA/scripts/snakemake/results/tumor_sample_1.filtered.bam
    output: results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr20.txt
    log: logs/titan/tumCounts/tumor_sample_1/tumor_sample_1.chrchr20.log
    jobid: 32
    wildcards: tumor=tumor_sample_1, chr=chr20
    threads: 2

[Wed Feb 10 16:33:36 2021]
Finished job 27.
18 of 36 steps (50%) done

[Wed Feb 10 16:33:36 2021]
rule getAlleleCountsByChr:
    input: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr19.vcf, /scratch/n/nicholsa/zyfniu/singularity_images/TitanCNA/scripts/snakemake/results/tumor_sample_1.filtered.bam
    output: results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr19.txt
    log: logs/titan/tumCounts/tumor_sample_1/tumor_sample_1.chrchr19.log
    jobid: 31
    wildcards: tumor=tumor_sample_1, chr=chr19
    threads: 2

[Wed Feb 10 16:38:44 2021]
Finished job 31.
19 of 36 steps (53%) done

[Wed Feb 10 16:38:44 2021]
rule getAlleleCountsByChr:
    input: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr21.vcf, /scratch/n/nicholsa/zyfniu/singularity_images/TitanCNA/scripts/snakemake/results/tumor_sample_1.filtered.bam
    output: results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr21.txt
    log: logs/titan/tumCounts/tumor_sample_1/tumor_sample_1.chrchr21.log
    jobid: 33
    wildcards: tumor=tumor_sample_1, chr=chr21
    threads: 2

[Wed Feb 10 16:40:06 2021]
Finished job 32.
20 of 36 steps (56%) done

[Wed Feb 10 16:40:06 2021]
rule getAlleleCountsByChr:
    input: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr22.vcf, /scratch/n/nicholsa/zyfniu/singularity_images/TitanCNA/scripts/snakemake/results/tumor_sample_1.filtered.bam
    output: results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr22.txt
    log: logs/titan/tumCounts/tumor_sample_1/tumor_sample_1.chrchr22.log
    jobid: 34
    wildcards: tumor=tumor_sample_1, chr=chr22
    threads: 2

[Wed Feb 10 16:43:32 2021]
Finished job 33.
21 of 36 steps (58%) done

[Wed Feb 10 16:43:32 2021]
rule getAlleleCountsByChr:
    input: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchrX.vcf, /scratch/n/nicholsa/zyfniu/singularity_images/TitanCNA/scripts/snakemake/results/tumor_sample_1.filtered.bam
    output: results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchrX.txt
    log: logs/titan/tumCounts/tumor_sample_1/tumor_sample_1.chrchrX.log
    jobid: 35
    wildcards: tumor=tumor_sample_1, chr=chrX
    threads: 2

[Wed Feb 10 16:43:51 2021]
Finished job 35.
22 of 36 steps (61%) done

[Wed Feb 10 16:43:51 2021]
rule ichorCNA:
    input: results/readDepth/tumor_sample_1.bin10000.wig, results/readDepth/normal_sample_1.bin10000.wig
    output: results/ichorCNA/tumor_sample_1/tumor_sample_1.correctedDepth.txt, results/ichorCNA/tumor_sample_1/tumor_sample_1.params.txt, results/ichorCNA/tumor_sample_1/tumor_sample_1.cna.seg, results/ichorCNA/tumor_sample_1/tumor_sample_1.seg.txt
    log: logs/ichorCNA/tumor_sample_1.log
    jobid: 12
    wildcards: tumor=tumor_sample_1
    resources: mem=4

[Wed Feb 10 16:44:11 2021]
Finished job 34.
23 of 36 steps (64%) done

[Wed Feb 10 16:44:11 2021]
rule catAlleleCountFiles:
    input: results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr1.txt, results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr2.txt, results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr3.txt, results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr4.txt, results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr5.txt, results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr6.txt, results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr7.txt, results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr8.txt, results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr9.txt, results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr10.txt, results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr11.txt, results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr12.txt, results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr13.txt, results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr14.txt, results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr15.txt, results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr16.txt, results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr17.txt, results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr18.txt, results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr19.txt, results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr20.txt, results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr21.txt, results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchr22.txt, results/titan/tumCounts/tumor_sample_1/tumor_sample_1.tumCounts.chrchrX.txt
    output: results/titan/tumCounts/tumor_sample_1.tumCounts.txt
    log: logs/titan/tumCounts/tumor_sample_1/tumor_sample_1.cat.log
    jobid: 11
    wildcards: tumor=tumor_sample_1
    threads: 2

[Wed Feb 10 16:44:11 2021]
Finished job 11.
24 of 36 steps (67%) done
[Wed Feb 10 17:44:14 2021]
Error in rule ichorCNA:
    jobid: 12
    output: results/ichorCNA/tumor_sample_1/tumor_sample_1.correctedDepth.txt, results/ichorCNA/tumor_sample_1/tumor_sample_1.params.txt, results/ichorCNA/tumor_sample_1/tumor_sample_1.cna.seg, results/ichorCNA/tumor_sample_1/tumor_sample_1.seg.txt
    log: logs/ichorCNA/tumor_sample_1.log (check log file(s) for error message)
    shell:
        singularity exec -B $SCRATCH/igenomes_ref,$SCRATCH/AN_WGS,$SCRATCH/AN_WGS/raw,$SCRATCH/singularity_images /gpfs/fs0/scratch/n/nicholsa/zyfniu/singularity_images/ichorcna_pz.simg Rscript /scratch/n/nicholsa/zyfniu/singularity_images/ichorCNA/scripts/runIchorCNA.R --libdir /scratch/n/nicholsa/zyfniu/singularity_images/ichorCNA/ --id tumor_sample_1 --WIG results/readDepth/tumor_sample_1.bin10000.wig --gcWig /scratch/n/nicholsa/zyfniu/igenomes_ref/gc_hg38_10kb.wig --mapWig /scratch/n/nicholsa/zyfniu/igenomes_ref/map_hg38_10kb.wig --NORMWIG results/readDepth/normal_sample_1.bin10000.wig --ploidy "c(2,3)" --normal "c(0.5)" --maxCN 8 --includeHOMD False --genomeStyle UCSC --chrs "c(1:22, \"X\")" --estimateNormal True --estimatePloidy True --estimateScPrevalence True --scStates "c(1,3)" --centromere /scratch/n/nicholsa/zyfniu/igenomes_ref/GRCh38.GCA_000001405.2_centromere_acen.txt --exons.bed None --txnE 0.9999 --txnStrength 10000 --fracReadsInChrYForMale 0.001 --plotFileType png --plotYLim "c(-2,4)" --outDir results/ichorCNA/tumor_sample_1/ > logs/ichorCNA/tumor_sample_1.log 2> logs/ichorCNA/tumor_sample_1.log
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job ichorCNA since they might be corrupted:
results/ichorCNA/tumor_sample_1/tumor_sample_1.correctedDepth.txt
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /gpfs/fs0/scratch/n/nicholsa/zyfniu/singularity_images/TitanCNA/scripts/snakemake/.snakemake/log/2021-02-10T134317.633011.snakemake.log
