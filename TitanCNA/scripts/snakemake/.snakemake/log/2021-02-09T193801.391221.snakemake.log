Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 4
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	all
	1	catAlleleCountFiles
	4	combineTitanAndIchorCNA
	1	copyOptSolution
	23	getAlleleCountsByChr
	23	getHETsites
	1	ichorCNA
	2	read_counter
	4	runTitanCNA
	1	selectSolution
	61

[Tue Feb  9 19:38:02 2021]
rule getHETsites:
    input: /scratch/n/nicholsa/zyfniu/AN_WGS/20210118_HPV_WGS/Recal/HPV33-N.recal.bam
    output: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr7.vcf
    log: logs/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr7.log
    jobid: 44
    wildcards: tumor=tumor_sample_1, chr=chr7


[Tue Feb  9 19:38:02 2021]
rule getHETsites:
    input: /scratch/n/nicholsa/zyfniu/AN_WGS/20210118_HPV_WGS/Recal/HPV33-N.recal.bam
    output: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr14.vcf
    log: logs/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr14.log
    jobid: 51
    wildcards: tumor=tumor_sample_1, chr=chr14


[Tue Feb  9 19:38:02 2021]
rule getHETsites:
    input: /scratch/n/nicholsa/zyfniu/AN_WGS/20210118_HPV_WGS/Recal/HPV33-N.recal.bam
    output: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr22.vcf
    log: logs/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr22.log
    jobid: 59
    wildcards: tumor=tumor_sample_1, chr=chr22


[Tue Feb  9 19:38:02 2021]
rule read_counter:
    input: /scratch/n/nicholsa/zyfniu/AN_WGS/20210118_HPV_WGS/Recal/HPV33-R.recal.bam
    output: results/readDepth/tumor_sample_1.bin10000.wig
    log: logs/readDepth/tumor_sample_1.bin10000.log
    jobid: 36
    wildcards: samples=tumor_sample_1, binSize=10000
    resources: mem=4

[Tue Feb  9 19:38:03 2021]
Error in rule read_counter:
    jobid: 36
    output: results/readDepth/tumor_sample_1.bin10000.wig
    log: logs/readDepth/tumor_sample_1.bin10000.log (check log file(s) for error message)
    shell:
        singularity exec -B $SCRATCH/igenomes_ref,$SCRATCH/AN_WGS,$SCRATCH/AN_WGS/raw,$SCRATCH/singularity_images /gpfs/fs0/scratch/n/nicholsa/zyfniu/singularity_images/ichorcna_pz.simg readCounter /scratch/n/nicholsa/zyfniu/AN_WGS/20210118_HPV_WGS/Recal/HPV33-R.recal.bam -c chr1,chr2,chr3,chr4,chr5,chr6,chr7,chr8,chr9,chr10,chr11,chr12,chr13,chr14,chr15,chr16,chr17,chr18,chr19,chr20,chr21,chr22,chrX,chrY -w 10000 -q 20 > results/readDepth/tumor_sample_1.bin10000.wig 2> logs/readDepth/tumor_sample_1.bin10000.log
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job read_counter since they might be corrupted:
results/readDepth/tumor_sample_1.bin10000.wig
Terminating processes on user request, this might take some time.
[Tue Feb  9 19:38:44 2021]
Error in rule getHETsites:
    jobid: 59
    output: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr22.vcf
    log: logs/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr22.log (check log file(s) for error message)
    shell:
        singularity exec -B $SCRATCH/igenomes_ref,$SCRATCH/AN_WGS,$SCRATCH/AN_WGS/raw,$SCRATCH/singularity_images /gpfs/fs0/scratch/n/nicholsa/zyfniu/singularity_images/nfcore-sarek-2.6.img samtools mpileup -uv -I -f /scratch/n/nicholsa/zyfniu/igenomes_ref/Homo_sapiens_assembly38.fasta -r chr22 -l /scratch/n/nicholsa/zyfniu/igenomes_ref/hapmap_3.3.hg38.vcf.gz /scratch/n/nicholsa/zyfniu/AN_WGS/20210118_HPV_WGS/Recal/HPV33-N.recal.bam | singularity exec -B $SCRATCH/igenomes_ref,$SCRATCH/AN_WGS,$SCRATCH/AN_WGS/raw,$SCRATCH/singularity_images /gpfs/fs0/scratch/n/nicholsa/zyfniu/singularity_images/nfcore-sarek-2.6.img bcftools call -v -c - | grep -e '0/1' -e '#' > results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr22.vcf 2> logs/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr22.log
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job getHETsites since they might be corrupted:
results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr22.vcf
[Tue Feb  9 19:38:44 2021]
Error in rule getHETsites:
    jobid: 51
    output: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr14.vcf
    log: logs/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr14.log (check log file(s) for error message)
    shell:
        singularity exec -B $SCRATCH/igenomes_ref,$SCRATCH/AN_WGS,$SCRATCH/AN_WGS/raw,$SCRATCH/singularity_images /gpfs/fs0/scratch/n/nicholsa/zyfniu/singularity_images/nfcore-sarek-2.6.img samtools mpileup -uv -I -f /scratch/n/nicholsa/zyfniu/igenomes_ref/Homo_sapiens_assembly38.fasta -r chr14 -l /scratch/n/nicholsa/zyfniu/igenomes_ref/hapmap_3.3.hg38.vcf.gz /scratch/n/nicholsa/zyfniu/AN_WGS/20210118_HPV_WGS/Recal/HPV33-N.recal.bam | singularity exec -B $SCRATCH/igenomes_ref,$SCRATCH/AN_WGS,$SCRATCH/AN_WGS/raw,$SCRATCH/singularity_images /gpfs/fs0/scratch/n/nicholsa/zyfniu/singularity_images/nfcore-sarek-2.6.img bcftools call -v -c - | grep -e '0/1' -e '#' > results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr14.vcf 2> logs/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr14.log
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job getHETsites since they might be corrupted:
results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr14.vcf
[Tue Feb  9 19:38:44 2021]
Error in rule getHETsites:
    jobid: 44
    output: results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr7.vcf
    log: logs/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr7.log (check log file(s) for error message)
    shell:
        singularity exec -B $SCRATCH/igenomes_ref,$SCRATCH/AN_WGS,$SCRATCH/AN_WGS/raw,$SCRATCH/singularity_images /gpfs/fs0/scratch/n/nicholsa/zyfniu/singularity_images/nfcore-sarek-2.6.img samtools mpileup -uv -I -f /scratch/n/nicholsa/zyfniu/igenomes_ref/Homo_sapiens_assembly38.fasta -r chr7 -l /scratch/n/nicholsa/zyfniu/igenomes_ref/hapmap_3.3.hg38.vcf.gz /scratch/n/nicholsa/zyfniu/AN_WGS/20210118_HPV_WGS/Recal/HPV33-N.recal.bam | singularity exec -B $SCRATCH/igenomes_ref,$SCRATCH/AN_WGS,$SCRATCH/AN_WGS/raw,$SCRATCH/singularity_images /gpfs/fs0/scratch/n/nicholsa/zyfniu/singularity_images/nfcore-sarek-2.6.img bcftools call -v -c - | grep -e '0/1' -e '#' > results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr7.vcf 2> logs/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr7.log
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job getHETsites since they might be corrupted:
results/titan/hetPosns/tumor_sample_1/tumor_sample_1.chrchr7.vcf
Complete log: /gpfs/fs0/scratch/n/nicholsa/zyfniu/singularity_images/TitanCNA/scripts/snakemake/.snakemake/log/2021-02-09T193801.391221.snakemake.log
